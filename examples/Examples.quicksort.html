<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Examples.quicksort</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="keyword">Equations</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Vector</span>.<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">vector</span> := <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Derive</span> <span class="id" title="var">NoConfusion</span> <span class="id" title="var">NoConfusionHom</span> <span class="id" title="keyword">for</span> <span class="id" title="var">vector</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Vector.nil</span> {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Vector.cons</span> {<span class="id" title="var">A</span>} <span class="id" title="var">_</span> {<span class="id" title="var">n</span>}.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot; x |:| y " := (@<span class="id" title="var">Vector.cons</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">vect_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot; x |: n :| y " := (@<span class="id" title="var">Vector.cons</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">vect_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;[]v" := <span class="id" title="var">Vector.nil</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0) : <span class="id" title="var">vect_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">vect_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">app</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span>) : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">app</span> []<span class="id" title="var">v</span> <span class="id" title="var">w</span> := <span class="id" title="var">w</span> ;<br/>
&nbsp;&nbsp;<span class="id" title="var">app</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>) <span class="id" title="var">w</span> := <span class="id" title="var">a</span> |:| <span class="id" title="var">app</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">In</span> {<span class="id" title="var">A</span> <span class="id" title="var">n</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">nil</span> := <span class="id" title="var">False</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>) := (<span class="id" title="var">x</span> = <span class="id" title="var">a</span>) ∨ <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="keyword">All</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Prop</span>) : <span class="id" title="keyword">∀</span> {<span class="id" title="var">n</span>}, <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span> → <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">All_nil</span> : <span class="id" title="keyword">All</span> <span class="id" title="var">P</span> <span class="id" title="var">nil</span><br/>
| <span class="id" title="var">All_cons</span> {<span class="id" title="var">a</span> <span class="id" title="var">n</span>} {<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>} : <span class="id" title="var">P</span> <span class="id" title="var">a</span> → <span class="id" title="keyword">All</span> <span class="id" title="var">P</span> <span class="id" title="var">v</span> → <span class="id" title="keyword">All</span> <span class="id" title="var">P</span> (<span class="id" title="var">a</span> |:| <span class="id" title="var">v</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">All_impl</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Prop</span>) {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) : (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> → <span class="id" title="var">Q</span> <span class="id" title="var">x</span>) → <span class="id" title="keyword">All</span> <span class="id" title="var">P</span> <span class="id" title="var">v</span> → <span class="id" title="keyword">All</span> <span class="id" title="var">Q</span> <span class="id" title="var">v</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> 2; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Derive</span> <span class="id" title="var">Signature</span> <span class="id" title="keyword">for</span> <span class="id" title="keyword">All</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">All_app</span> {<span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="keyword">All</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">_</span> <span class="id" title="var">v</span> → <span class="id" title="keyword">All</span> <span class="id" title="var">P</span> <span class="id" title="var">w</span> → <span class="id" title="keyword">All</span> <span class="id" title="var">P</span> (<span class="id" title="var">app</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">funelim</span> (<span class="id" title="var">app</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>). <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">In_All</span> {<span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) : <span class="id" title="keyword">All</span> <span class="id" title="var">P</span> <span class="id" title="var">v</span> ↔ (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span> → <span class="id" title="var">P</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">induction</span> 1. <span class="id" title="tactic">intros</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">simpl</span>. <span class="id" title="var">simp</span> <span class="id" title="var">In</span>. <span class="id" title="tactic">intuition</span>. <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>; <span class="id" title="var">simp</span> <span class="id" title="var">In</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">firstorder</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Lemma&nbsp;All_In_All&nbsp;{A&nbsp;P&nbsp;n&nbsp;m}&nbsp;(v&nbsp;:&nbsp;vector&nbsp;A&nbsp;n)&nbsp;(v'&nbsp;:&nbsp;vector&nbsp;A&nbsp;m)&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;All&nbsp;(fun&nbsp;x&nbsp;=&gt;&nbsp;In&nbsp;x&nbsp;v)&nbsp;v'&nbsp;-&gt;&nbsp;All&nbsp;P&nbsp;v&nbsp;-&gt;&nbsp;All&nbsp;P&nbsp;v'.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;induction&nbsp;1.&nbsp;simpl.&nbsp;constructor.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;intros.&nbsp;constructor;&nbsp;auto.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;eapply&nbsp;In_All;&nbsp;eauto.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Sorted</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="keyword">Prop</span>) : <span class="id" title="keyword">∀</span> {<span class="id" title="var">n</span>}, <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span> → <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">Sorted_nil</span> : <span class="id" title="var">Sorted</span> <span class="id" title="var">R</span> <span class="id" title="var">nil</span><br/>
| <span class="id" title="var">Sorted_cons</span> {<span class="id" title="var">a</span> <span class="id" title="var">n</span>} {<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>} : <span class="id" title="keyword">All</span> (<span class="id" title="var">R</span> <span class="id" title="var">a</span>) <span class="id" title="var">v</span> → <span class="id" title="var">Sorted</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span> → <span class="id" title="var">Sorted</span> <span class="id" title="var">R</span> (<span class="id" title="var">a</span> |:| <span class="id" title="var">v</span>).<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Sigma_Notations</span>.<br/>
<span class="id" title="keyword">Derive</span> <span class="id" title="var">Signature</span> <span class="id" title="keyword">for</span> <span class="id" title="var">Sorted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Sorted_app</span> {<span class="id" title="var">A</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">Sorted</span> <span class="id" title="var">A</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> <span class="id" title="var">v</span> → <span class="id" title="var">Sorted</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">Sorted</span> <span class="id" title="var">R</span> (<span class="id" title="var">app</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">In_app</span> {<span class="id" title="var">A</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span> ∨ <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">w</span> ↔ <span class="id" title="var">In</span> <span class="id" title="var">a</span> (<span class="id" title="var">app</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">funelim</span> (<span class="id" title="var">app</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>). <span class="id" title="tactic">intuition</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="var">depelim</span> <span class="id" title="var">H0</span>; <span class="id" title="var">simp</span> <span class="id" title="var">In</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">intuition</span>. <span class="id" title="var">simp</span> <span class="id" title="var">In</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">intuition</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Sumbool</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">dec</span> <span class="id" title="var">x</span> := (<span class="id" title="var">sumbool_of_bool</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">QuickSort</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">leb</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">bool</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">leb_inverse</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">leb</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">false</span> → <span class="id" title="var">leb</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> = <span class="id" title="var">true</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">sorted</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) := <span class="id" title="var">Sorted</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ⇒ <span class="id" title="var">leb</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">true</span>) <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Set</span> <span class="id" title="var">Program</span> <span class="id" title="var">Mode</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Equations</span>? <span class="id" title="var">filter</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">bool</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Σ</span> (<span class="id" title="var">k</span> : <span class="id" title="var">nat</span>), { <span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">k</span> | <span class="id" title="var">k</span> ≤ <span class="id" title="var">n</span> ∧ <span class="id" title="keyword">All</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">true</span>) <span class="id" title="var">v</span> } :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">filter</span> <span class="id" title="var">nil</span>        <span class="id" title="var">f</span> := (0, <span class="id" title="var">nil</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">filter</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">v'</span>) <span class="id" title="var">f</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dec</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ | <span class="id" title="tactic">left</span> <span class="id" title="var">H</span> ⇒ (<span class="id" title="var">_</span>, <span class="id" title="var">cons</span> <span class="id" title="var">a</span> (<span class="id" title="var">filter</span> <span class="id" title="var">v'</span> <span class="id" title="var">f</span>).2);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">right</span> <span class="id" title="var">H</span> ⇒ (<span class="id" title="var">_</span>, (<span class="id" title="var">filter</span> <span class="id" title="var">v'</span> <span class="id" title="var">f</span>).2) }.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">filter</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">n'</span> [<span class="id" title="var">v''</span> [<span class="id" title="var">Hn'</span> <span class="id" title="var">Hv'</span>]]]. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">filter</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">n'</span> [<span class="id" title="var">v''</span> [<span class="id" title="var">Hn'</span> <span class="id" title="var">Hv'</span>]]]. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Equations</span>? <span class="id" title="var">pivot</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">bool</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Σ</span> (<span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">v'</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">k</span>), { <span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">k</span> + <span class="id" title="var">l</span> = <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧ <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span> ↔<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">if</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="keyword">then</span> <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">v'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">w</span>) } :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;All&nbsp;(fun&nbsp;x&nbsp;=&gt;&nbsp;In&nbsp;x&nbsp;v&nbsp;/\&nbsp;f&nbsp;x&nbsp;=&nbsp;true)&nbsp;v'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;/\&nbsp;All&nbsp;(fun&nbsp;x&nbsp;=&gt;&nbsp;In&nbsp;x&nbsp;v&nbsp;/\&nbsp;f&nbsp;x&nbsp;=&nbsp;false)&nbsp;w&nbsp;}&nbsp;}&nbsp;}&nbsp;}&nbsp;:=&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pivot</span> <span class="id" title="var">nil</span>        <span class="id" title="var">f</span> := (0 , 0 , <span class="id" title="var">nil</span>, <span class="id" title="var">nil</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pivot</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">v'</span>) <span class="id" title="var">f</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dec</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>), <span class="id" title="var">pivot</span> <span class="id" title="var">v'</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ | <span class="id" title="tactic">left</span> <span class="id" title="var">H</span> | (<span class="id" title="var">k</span>, <span class="id" title="var">l</span>, <span class="id" title="var">v</span>, <span class="id" title="var">w</span>) ⇒ (<span class="id" title="var">_</span> , <span class="id" title="var">_</span>, <span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>, <span class="id" title="var">w</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">right</span> <span class="id" title="var">H</span> | (<span class="id" title="var">k</span>, <span class="id" title="var">l</span>, <span class="id" title="var">v</span>, <span class="id" title="var">w</span>) ⇒ (<span class="id" title="var">_</span> , <span class="id" title="var">_</span>, <span class="id" title="var">v</span>, <span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">w</span>) }.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="var">simp</span> <span class="id" title="var">In</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">intuition</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">simp</span> <span class="id" title="var">In</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">intuition</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">proj1</span> (<span class="id" title="var">i</span> <span class="id" title="var">_</span>) <span class="id" title="var">H0</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">i</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="var">simp</span> <span class="id" title="var">In</span>; <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">proj1</span> (<span class="id" title="var">i</span> <span class="id" title="var">_</span>) <span class="id" title="var">H1</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">i</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Equations</span>? <span class="id" title="var">qs</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) : { <span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span> | <span class="id" title="var">sorted</span> <span class="id" title="var">v</span> ∧ (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> ↔ <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span>) } <span class="id" title="tactic">by</span> <span class="id" title="keyword">wf</span> <span class="id" title="var">n</span> <span class="id" title="var">lt</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">qs</span> <span class="id" title="var">nil</span> := <span class="id" title="var">nil</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">qs</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>) <span class="id" title="keyword">with</span> <span class="id" title="var">pivot</span> <span class="id" title="var">v</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">leb</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ | (<span class="id" title="var">k</span>, <span class="id" title="var">l</span>, <span class="id" title="var">lower</span>, <span class="id" title="var">higher</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">app</span> (<span class="id" title="var">qs</span> <span class="id" title="var">lower</span>) (<span class="id" title="var">a</span> |:| <span class="id" title="var">qs</span> <span class="id" title="var">higher</span>) }.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>:<span class="id" title="tactic">simpl</span>. <span class="id" title="var">all</span>:<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">destruct</span> <span class="id" title="var">qs</span>; <span class="id" title="tactic">simpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">trivial</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">eq_sym</span> (<span class="id" title="var">plus_n_Sm</span> <span class="id" title="var">k</span> <span class="id" title="var">l</span>)). <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Sorted_app</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">In_All</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> <span class="id" title="var">Inx1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Inx1</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">leb_inverse</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">All_In_All</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">All_impl</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> [<span class="id" title="var">inx1</span> <span class="id" title="var">lebx1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">leb_inverse</span>; <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">All_app</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">All_In_All</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">All_impl</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> [<span class="id" title="var">inx1</span> <span class="id" title="var">lebx1</span>]. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">All_In_All</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">All_impl</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> [<span class="id" title="var">Inx1</span> <span class="id" title="var">lebx1</span>]. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">qs_forget</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span> := <span class="id" title="var">qs</span> <span class="id" title="var">l</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof&nbsp;after&nbsp;the&nbsp;definition.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">All_In</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) <span class="id" title="var">P</span> : <span class="id" title="keyword">All</span> <span class="id" title="var">P</span> <span class="id" title="var">v</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span> → <span class="id" title="var">P</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> 1. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">Hx</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">Hx</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">All_In_self</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) : <span class="id" title="keyword">All</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span>) <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">All_impl</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">program_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">program_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">qs_all</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">qs_forget</span> <span class="id" title="var">l</span>) → <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">qs_forget</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">qs</span> <span class="id" title="var">l</span>). <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="var">All_In</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H0</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">all_qs</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> → <span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">qs_forget</span> <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">qs_forget</span>. <span class="id" title="var">funelim</span> (<span class="id" title="var">qs</span> <span class="id" title="var">l</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">qs_obligation_4</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">In_app</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">pr6</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">All_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">pr6</span>; <span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">All_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">qs_all</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">qs_forget</span> <span class="id" title="var">l</span>) → <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">qs_forget</span>. <span class="id" title="var">funelim</span> (<span class="id" title="var">qs</span> <span class="id" title="var">l</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">qs_obligation_4</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">In_app</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">pr6</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">All_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">pr6</span>; <span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">depelim</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">All_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">intuition</span> <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">qs_equiv</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> ↔ <span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">qs_forget</span> <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">using</span> <span class="id" title="var">qs_all</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">qs_forget</span>. <span class="id" title="var">funelim</span> (<span class="id" title="tactic">destruct</span> <span class="id" title="var">qs</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="var">All_In</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">All_In_self</span> <span class="id" title="var">x0</span>). <span class="id" title="tactic">eapply</span> <span class="id" title="var">All_In_All</span> <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">QuickSort</span>.<br/>

<br/>
<span class="id" title="keyword">Extraction</span> <span class="id" title="keyword">Inline</span> <span class="id" title="var">pivot</span>.<br/>
<span class="id" title="keyword">Extraction</span> <span class="id" title="var">qs</span>.<br/>
</div>
<hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>